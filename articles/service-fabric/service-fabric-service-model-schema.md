---
title: Azure Service Fabric service model XML schema descriptions | Microsoft Docs
description: Describes the XML schema of the Service Fabric service model.
services: service-fabric
documentationcenter: na
author: athinanthny
manager: chackdan
editor: 
ms.assetid: 
ms.service: service-fabric
ms.topic: reference
ms.tgt_pltfrm: na
ms.workload: multiple
ms.date: 12/10/2018
ms.author: atsenthi
---

<!-- The schema reference articles were generated by the Python script found in the end of this file -->

# Service model XML schema documentation
This article documents the ServiceFabricServiceModel.xsd schema file installed with the Service Fabric SDK.  By default, the schema file is installed to *C:\Program Files\Microsoft SDKs\Service Fabric\schemas\ServiceFabricServiceModel.xsd*.

## Namespace bindings

|Prefix|Namespace URI|
|---|---|
|xs|https:\//www.w3.org/2001/XMLSchema|

## Component summary 
The following components are defined in ServiceFabricServiceModel.xsd:
- [257 elements](service-fabric-service-model-schema-elements.md)
- [112 complexTypes](service-fabric-service-model-schema-complex-types.md)
- [1 simpleTypes](service-fabric-service-model-schema-simple-types.md)
- [3 element groups](service-fabric-service-model-schema-element-groups.md)
- [16 attribute groups](service-fabric-service-model-schema-attribute-groups.md)



<!--  Python script BuildServiceModelSchemaArticle.py used to generate this article:

try:
    from lxml import etree
    from lxml import objectify
except ImportError:
    import xml.etree.ElementTree as etree

import datetime
from itertools import groupby
import operator

import sfschemapy

def writeOverviewFile(filename, namedElements, namedComplexTypes, namedElementGroups, namedAttributeGroups, namedSimpleTypes , NSMAP):
    # 
    # Open overview output file
    with open(filename,'w') as file: 

        # Write header info
        file.write('---\n')
        file.write('title: Azure Service Fabric service model XML schema descriptions | Microsoft Docs\n')
        file.write('description: Describes the XML schema of the Service Fabric service model.\n')
        file.write('services: service-fabric\n')
        file.write('documentationcenter: na\n')
        file.write('author: athinanthny\n')
        file.write('manager: chackdan\n')
        file.write('editor: ''\n')

        file.write('ms.assetid: \n')
        file.write('ms.service: service-fabric\n')
        file.write('ms.topic: reference\n')
        file.write('ms.tgt_pltfrm: na\n')
        file.write('ms.workload: multiple\n')
        file.write('ms.date: %s\n' % datetime.datetime.today().strftime('%m/%d/%Y'))
        file.write('ms.author: atsenthi\n')

        file.write('---\n\n')
        file.write('<!-- The schema reference articles were generated by the Python script found in the end of this file - ->\n\n')
        file.write('# Service model XML schema documentation\n')
        file.write('This article documents the ServiceFabricServiceModel.xsd schema file installed with the Service Fabric SDK.  By default, the schema file is ')
        file.write('installed to *C:\Program Files\Microsoft SDKs\Service Fabric\schemas\ServiceFabricServiceModel.xsd*.\n\n')

        file.write('## Namespace bindings\n')
        file.write('|Prefix|Namespace URI|\n')
        file.write('|---|---|\n')

        for ns in NSMAP.items():
            file.write( '|%s|%s|\n' % (ns[0], ns[1]) )

        file.write('\n')

        file.write('## Component summary \n')
        file.write('The following components are defined in the http://schemas.microsoft.com/2011/01/fabric namespace in ServiceFabricServiceModel.xsd:\n')
        file.write('- [%i elements](service-fabric-service-model-schema-elements.md)\n' % len(namedElements))
        file.write('- [%i complexTypes](service-fabric-service-model-schema-complex-types.md)\n' % len(namedComplexTypes))
        file.write('- [%i simpleTypes](service-fabric-service-model-schema-simple-types.md)\n' % len(namedSimpleTypes))
        file.write('- [%i element groups](service-fabric-service-model-schema-element-groups.md)\n' % len(namedElementGroups))
        file.write('- [%i attribute groups](service-fabric-service-model-schema-attribute-groups.md)\n' % len(namedAttributeGroups))
        file.write('\n')

        #
        # Add this script to the article.
        file.write('\n\n<!--  Python script BuildServiceModelSchemaArticle.py used to generate this article:\n\n')
        with open('BuildServiceModelSchemaArticle.py','r') as file2:

            lines = file2.readlines()
            for line in lines:
                file.write(line)
            file.write('\n\n- ->')        

        file.write('\n')
        file.write('\n')
        file.write('\n\n<!--  Python module sfschemapy.py used to generate this article:\n\n')
        with open('sfschemapy.py','r') as file3:

            lines = file3.readlines()
            for line in lines:
                file.write(line)
            file.write('\n\n- ->')

          

def writeElementGroupsFile(filename, namedElementGroups):
    # 
    # Open element groups output file
    with open(filename,'w') as file:

        # Write header info
        file.write('---\n')
        file.write('title: Azure Service Fabric service model XML schema element groups | Microsoft Docs\n')
        file.write('description: Describes the element groups in the XML schema of the Service Fabric service model.\n')
        file.write('services: service-fabric\n')
        file.write('documentationcenter: na\n')
        file.write('author: athinanthny\n')
        file.write('manager: chackdan\n')
        file.write('editor: ''\n')

        file.write('ms.assetid: \n')
        file.write('ms.service: service-fabric\n')
        file.write('ms.topic: reference\n')
        file.write('ms.tgt_pltfrm: na\n')
        file.write('ms.workload: multiple\n')
        file.write('ms.date: %s\n' % datetime.datetime.today().strftime('%m/%d/%Y'))
        file.write('ms.author: atsenthi\n')

        file.write('---\n\n')
        file.write('<!-- This article was generated by the Python script found in the service-fabric-service-model-schema.md file -- >\n\n')
        file.write('# Service model XML schema elements\n')
        file.write('\n')
        # 
        # Write Element groups
        print('Writing elements groups...')
        orderedElementGroups = sorted(namedElementGroups,key=lambda x: x.Name)
        for e in orderedElementGroups:    
     
            file.write('## %s group\n' % e.Name)
            if e.Documentation:
                file.write('%s\n\n' % e.Documentation) 
    
            file.write('|Attribute|Value|\n')
            file.write('|---|---|\n')
            file.write('|content|%d element(s)|\n' % len(e.ContentElements) )

            file.write('\n')         
            file.write('### XML source\n')
            file.write('```xml\n')
            file.write('%s\n' % e.XmlSource)
            file.write('```\n')

            if(e.ContentElements):
                file.write('### Content element details\n')
                for c in e.ContentElements:
                    file.write('\n#### %s\n' % c.Name)

                    if(c.Documentation):
                        file.write('%s\n' % c.Documentation)

                    file.write('|Attribute|Value|\n')
                    file.write('|---|---|\n')
                    for key,value in c.TagAttributes.items():                
                        file.write('|%s|%s|\n' % (key,value))                
            
                    file.write('\n##### XML source\n')
                    file.write('```xml\n')
                    file.write('%s\n' % c.XmlSource)
                    file.write('```\n')
            
        
            file.write('\n')

def writeElementsFile(filename, namedElements):
    # 
    # Open elements output file
    with open(filename,'w') as file:

        # Write header info
        file.write('---\n')
        file.write('title: Azure Service Fabric service model XML schema elements | Microsoft Docs\n')
        file.write('description: Describes the elements in the XML schema of the Service Fabric service model.\n')
        file.write('services: service-fabric\n')
        file.write('documentationcenter: na\n')
        file.write('author: athinanthny\n')
        file.write('manager: chackdan\n')
        file.write('editor: ''\n')

        file.write('ms.assetid: \n')
        file.write('ms.service: service-fabric\n')
        file.write('ms.topic: reference\n')
        file.write('ms.tgt_pltfrm: na\n')
        file.write('ms.workload: multiple\n')
        file.write('ms.date: %s\n' % datetime.datetime.today().strftime('%m/%d/%Y'))
        file.write('ms.author: atsenthi\n')

        file.write('---\n\n')
        file.write('<!-- This article was generated by the Python script found in the service-fabric-service-model-schema.md file -- >\n\n')
        file.write('# Service model XML schema elements\n')
        file.write('\n')
        # 
        # Write Elements
        print('Writing elements...')

        # group by element name
        orderedElements = sorted(namedElements,key=lambda x: (x.Name, x.Id))        
        for key, group in groupby(orderedElements, lambda x: x.Name):
            elements = list(group)
            #print(key )
            #print(len(elements))            

            for e in elements:    

                file.write('<a id="%s"></a>\n'%e.Id)
                # May be more than one element of same name
                if len(elements) > 1:                 

                    if e.Type=="anonymous complexType":
                        file.write('## %s element (defined in %s) \n' % (e.Name, e.DefinedIn[0][0]))
                    else:
                        file.write('## %s element (type %s) \n' % (e.Name,e.Type))
                else:
                    file.write('## %s element\n' % e.Name)

                if len(e.Documentation)>0:
                    file.write('%s\n\n' % e.Documentation) 
                
                file.write('|Attribute|Value|\n')
                file.write('|---|---|\n')
    
                if (e.Type=='anonymous complexType') or (e.Type=='xs:int') or (e.Type=='xs:string') or (e.Type=='xs:boolean') or (e.Type=='xs:long'):
                    file.write('|type|%s|\n' % e.Type)
                else:
                    file.write('|type|[%s](service-fabric-service-model-schema-complex-types.md#%s-complextype)|\n' % (e.Type, e.Type.lower()))
    
                file.write('|content|%d element(s), %d attribute(s)|\n' % ( len(e.ContentElements), len(e.Attributes) ) )
                
                if(e.IsGlobal):
                    file.write('|defined|globally|\n')
                else:
                    # list where the element is defined
                    definlist=[]
                    for defin in e.DefinedIn:
                        
                        if (defin[1] == 'element'):
                            # To do- better element linking
                            #definlist.append("[%s element](service-fabric-service-model-schema-elements.md#%s-element)"%(defin[0], defin[0].lower()))
                            definlist.append("%s element"%(defin[0]))
                        elif(defin[1] == 'group'):
                            definlist.append("[%s group](service-fabric-service-model-schema-element-groups.md#%s-group)"%(defin[0], defin[0].lower()))
                        else:
                            definlist.append("[%s complexType](service-fabric-service-model-schema-complex-types.md#%s-complextype)"%(defin[0], defin[0].lower()))

                    file.write('|defined|locally in %s|\n' % ", ".join(definlist))

                for key,value in e.TagAttributes.items():    
                    if key != 'type':    
                        file.write('|%s|%s|\n' % (key,value))
                file.write('\n')         
                file.write('### XML source\n')
                file.write('```xml\n')
                file.write('%s\n' % e.XmlSource)
                file.write('```\n')
                if(e.Attributes):
                    file.write('### Attribute details\n')        
                    for attr in e.Attributes:
                        file.write('\n#### %s\n' % attr.Name)
                        if(attr.Documentation):
                            file.write('%s\n' % attr.Documentation)
 
                        file.write('|Attribute|Value|\n')
                        file.write('|---|---|\n')
                        for key,value in attr.Attributes.items():                
                            file.write('|%s|%s|\n' % (key,value))
                        """
                        file.write('##### XML source\n')
                        file.write('```xml\n')
                        file.write('%s\n' %attr.XmlSource)
                        file.write('```\n')
                        """
                    file.write('\n')

                if(e.ContentElements):
                    file.write('### Content element details\n')
                    for c in e.ContentElements:
                        file.write('\n#### %s\n' % c.Name)

                        if(c.Documentation):
                            file.write('%s\n' % c.Documentation)

                        file.write('|Attribute|Value|\n')
                        file.write('|---|---|\n')
                        for key,value in c.TagAttributes.items():   
                            if(key=='type'):
                                if(value=='xs:int') or (value=='xs:string') or (value=='xs:boolean') or (value=='xs:long'):
                                    file.write('|%s|%s|\n' % (key,value))        
                                else:
                                     file.write('|%s|[%s](service-fabric-service-model-schema-complex-types.md#%s-complextype)|\n' % (key,value,value.lower()))         
                            else:             
                                file.write('|%s|%s|\n' % (key,value))           
            
                        """
                        file.write('\n##### XML source\n')
                        file.write('```xml\n')
                        file.write('%s\n' % c.XmlSource)
                        file.write('```\n')
                        """
        
                file.write('\n')
 

def writeComplexTypesFile(filename, namedComplexTypes):
    # 
    # Open complex types output file
    with open(filename,'w') as file:  

        # Write header info
        file.write('---\n')
        file.write('title: Azure Service Fabric service model XML schema complex types | Microsoft Docs\n')
        file.write('description: Describes the complex types in the XML schema of the Service Fabric service model.\n')
        file.write('services: service-fabric\n')
        file.write('documentationcenter: na\n')
        file.write('author: athinanthny\n')
        file.write('manager: chackdan\n')
        file.write('editor: ''\n')

        file.write('ms.assetid: \n')
        file.write('ms.service: service-fabric\n')
        file.write('ms.topic: reference\n')
        file.write('ms.tgt_pltfrm: na\n')
        file.write('ms.workload: multiple\n')
        file.write('ms.date: %s\n' % datetime.datetime.today().strftime('%m/%d/%Y'))
        file.write('ms.author: atsenthi\n')

        file.write('---\n\n')
        file.write('<!-- This article was generated by the Python script found in the service-fabric-service-model-schema.md file -- >\n\n')
        file.write('# Service model XML schema complex types \n')
        file.write('\n')
        # 
        # Write complexTypes
        print('Writing complexTypes...')
        orderedComplexTypes = sorted(namedComplexTypes,key=lambda x: x.Name)
        for t in orderedComplexTypes:    
     
            file.write('## %s complexType\n' % t.Name)
            if t.Documentation:
                file.write('%s\n\n' % t.Documentation) 
            file.write('|Attribute|Value|\n')
            file.write('|---|---|\n')    
    
            #else:
            #    file.write('|type|complexType|\n')    
    
            file.write('|content|%d element(s), %d attribute(s)|\n' % ( len(t.ContentElements), len(t.Attributes) ) )

            if(t.IsGlobal):
                file.write('|defined|globally|\n')
            else:
                file.write('|defined|locally|\n')

            for key,value in t.TagAttributes.items():    
                file.write('|%s|%s|\n' % (key,value))
        
            file.write('\n')         
            file.write('### XML source\n')
            file.write('```xml\n')
            file.write('%s\n' % t.XmlSource)
            file.write('```\n')

            if(t.Attributes):
                file.write('### Attribute details\n')        
                for attr in t.Attributes:
                    file.write('\n#### %s\n' % attr.Name)
                    if(attr.Documentation):
                        file.write('%s\n' % attr.Documentation)
 
                    file.write('|Attribute|Value|\n')
                    file.write('|---|---|\n')
                    for key,value in attr.Attributes.items():                
                        file.write('|%s|%s|\n' % (key,value))
                    """
                    file.write('##### XML source\n')
                    file.write('```xml\n')
                    file.write('%s\n' %attr.XmlSource)
                    file.write('```\n')  
                    """  
                file.write('\n')

            if(t.ContentElements):
                file.write('### Content element details\n')
                for c in t.ContentElements:
                    file.write('\n#### %s\n' % c.Name)

                    if(c.Documentation):
                        file.write('%s\n' % c.Documentation)

                    file.write('|Attribute|Value|\n')
                    file.write('|---|---|\n')
                    for key,value in c.TagAttributes.items(): 
                        if(key=='type'):
                            if(value=='xs:int') or (value=='xs:string') or (value=='xs:boolean') or (value=='xs:long'):
                                file.write('|%s|%s|\n' % (key,value))        
                            else:
                                file.write('|%s|[%s](#%s-complextype)|\n' % (key,value,value.lower()))         
                        else:             
                            file.write('|%s|%s|\n' % (key,value))               
                          
            
                    """
                    file.write('\n##### XML source\n')
                    file.write('```xml\n')
                    file.write('%s\n' % c.XmlSource)
                    file.write('```\n')
                    """

def writeAttributesFile(filename, namedAttributeGroups):
    # 
    # Open attribute groups output file
    with open(filename,'w') as file:

        # Write header info
        file.write('---\n')
        file.write('title: Azure Service Fabric service model XML schema attribute groups | Microsoft Docs\n')
        file.write('description: Describes the attribute groups in the XML schema of the Service Fabric service model.\n')
        file.write('services: service-fabric\n')
        file.write('documentationcenter: na\n')
        file.write('author: athinanthny\n')
        file.write('manager: chackdan\n')
        file.write('editor: ''\n')

        file.write('ms.assetid: \n')
        file.write('ms.service: service-fabric\n')
        file.write('ms.topic: reference\n')
        file.write('ms.tgt_pltfrm: na\n')
        file.write('ms.workload: multiple\n')
        file.write('ms.date: %s\n' % datetime.datetime.today().strftime('%m/%d/%Y'))
        file.write('ms.author: atsenthi\n')

        file.write('---\n\n')
        file.write('<!-- This article was generated by the Python script found in the service-fabric-service-model-schema.md file -- >\n\n')
        file.write('# Service model XML schema attribute groups\n')
        file.write('\n')
        # 
        # Write attributeGroups
        print('Writing attributeGroups...')
        orderedAttributeGroups = sorted(namedAttributeGroups,key=lambda x: x.Name)
        for ag in orderedAttributeGroups:    
     
            file.write('## %s attributeGroup\n' % ag.Name)
            if ag.Documentation:
                file.write('%s\n\n' % ag.Documentation) 
            file.write('|Attribute|Value|\n')
            file.write('|---|---|\n')
        
            file.write('|content|%d attribute(s)|\n' % ( len(ag.GroupAttributes) ) )
            for key,value in ag.TagAttributes.items():    
                    if key != 'type':    
                        file.write('|%s|%s|\n' % (key,value))
            file.write('\n')         
            file.write('### XML source\n')
            file.write('```xml\n')
            file.write('%s\n' % ag.XmlSource)
            file.write('```\n')

            if(ag.GroupAttributes):
                file.write('### Attribute details\n')        
                for attr in ag.GroupAttributes:
                    file.write('\n#### %s\n' % attr.Name)
                    if(attr.Documentation):
                        file.write('%s\n' % attr.Documentation)
 
                    file.write('|Attribute|Value|\n')
                    file.write('|---|---|\n')
                    for key,value in attr.Attributes.items():                
                        file.write('|%s|%s|\n' % (key,value))
                    file.write('##### XML source\n')
                    file.write('```xml\n')
                    file.write('%s\n' %attr.XmlSource)
                    file.write('```\n')    
                file.write('\n')
  
def writeSimpleTypesFile(filename, namedSimpleTypes):

    # 
    # Open simple types output file
    with open(filename,'w') as file:

        # Write header info
        file.write('---\n')
        file.write('title: Azure Service Fabric service model XML schema simple types | Microsoft Docs\n')
        file.write('description: Describes the simple types in the XML schema of the Service Fabric service model.\n')
        file.write('services: service-fabric\n')
        file.write('documentationcenter: na\n')
        file.write('author: athinanthny\n')
        file.write('manager: chackdan\n')
        file.write('editor: ''\n')

        file.write('ms.assetid: \n')
        file.write('ms.service: service-fabric\n')
        file.write('ms.topic: reference\n')
        file.write('ms.tgt_pltfrm: na\n')
        file.write('ms.workload: multiple\n')
        file.write('ms.date: %s\n' % datetime.datetime.today().strftime('%m/%d/%Y'))
        file.write('ms.author: atsenthi\n')

        file.write('---\n\n')
        file.write('<!-- This article was generated by the Python script found in the service-fabric-service-model-schema.md file -- >\n\n')
        file.write('# Service model XML schema simple types\n')
        file.write('\n')

        # 
        # Write simpleTypes
        print('Writing simpleTypes...')
        orderedSimpleTypes = sorted(namedSimpleTypes,key=lambda x: x.Name)
        for t in orderedSimpleTypes:    
     
            file.write('## %s simpleType\n' % t.Name)
            if (t.Documentation):
                file.write('%s\n\n' % t.Documentation)

            file.write('### XML source\n')
            file.write('```xml\n')
            file.write('%s\n' % t.XmlSource)
            file.write('```\n')

def main():

    #tree = etree.parse('C:\\Program Files\\Microsoft SDKs\\Service Fabric\\schemas\\ServiceFabricServiceModel.xsd')
    tree = etree.parse('ServiceFabricServiceModel.xsd')
    
    NSMAP = {'xs': 'https://www.w3.org/2001/XMLSchema'}

    namedElements = sfschemapy.getElements(tree, NSMAP)
    namedComplexTypes = sfschemapy.getComplexTypes(tree, NSMAP)
    namedElementGroups  = sfschemapy.getElementGroups(tree, NSMAP)
    namedAttributeGroups = sfschemapy.getAttributeGroups(tree, NSMAP)
    namedSimpleTypes = sfschemapy.getSimpleTypes(tree, NSMAP)

    print("Number of elements: %i" % len(namedElements))
    print("Number of complexTypes: %i" % len(namedComplexTypes))

    writeOverviewFile('service-fabric-service-model-schema.md', namedElements, namedComplexTypes, namedElementGroups, namedAttributeGroups, namedSimpleTypes , NSMAP)
    writeElementGroupsFile('service-fabric-service-model-schema-element-groups.md', namedElementGroups)
    writeElementsFile('service-fabric-service-model-schema-elements.md', namedElements)
    writeComplexTypesFile('service-fabric-service-model-schema-complex-types.md', namedComplexTypes)
    writeAttributesFile('service-fabric-service-model-schema-attribute-groups.md', namedAttributeGroups)
    writeSimpleTypesFile('service-fabric-service-model-schema-simple-types.md', namedSimpleTypes)

if __name__ == "__main__": 
    main()

-->



<!--  Python module sfschemapy.py used to generate this article:


try:
    from lxml import etree
    from lxml import objectify
except ImportError:
    import xml.etree.ElementTree as etree

import datetime

class Element(object):
    def __init__(self):
        self.Name = ""
        self.Documentation=""
        self.TagAttributes={}
        self.Attributes=[]
        self.ContentElements=[]
        self.XmlSource=""      
        self.IsGlobal=False
        self.DefinedIn=[]  
        self.Type=None
        self.Id=""

class ComplexType(object):
    def __init__(self):
        self.Name=""
        self.Documentation=""
        self.TagAttributes={}
        self.Attributes=[]
        self.ContentElements=[]        
        self.IsGlobal=False

class Attribute(object):
    def __init__(self):
        self.Name=""
        self.Documentation=""
        self.TagAttributes = {}
        self.Attributes=[]
        self.XmlSource = ""

class AttributeGroup(object):
    def __init__(self):
        self.Name=""
        self.Documentation=""
        self.TagAttributes = {}
        self.GroupAttributes=[]
        self.XmlSource = ""

class ElementsGroup(object):
    def __init__(self):
        self.Name=""
        self.Documentation=""
        self.TagAttributes = {}
        self.GroupAttributes=[]
        self.XmlSource = ""
        self.ContentElements=[]

class SimpleType(object):
    def __init__(self):
        self.Name=""
        self.Documentation=""
        self.XmlSource = ""


def lookupElementId(elements, name, parentName):
    """Returns the element ID or empty string if element not found.
    """
    element = lookupElement(elements, name, parentName)     

    if(element):
        return element.Id                
    else:
        return ""

def lookupElement(elements, name, parentName):
    """Returns the element ID or empty string if element not found.
    """
    
    element=None

    # The element is global
    if parentName =="":
        for x in elements:
            if (x.Name == name and x.IsGlobal):
                element = x
                break
    else:

        for x in filter(lambda x: x.Name == name, elements):   
            # Parent is an element
            if (parentName, "element") in x.DefinedIn:
                element = x
                break

            else:
                # find type(s) of possible parent elements, match in elements DefinedIn list
                for p in filter(lambda y: y.Name == parentName, elements):
                    if (p.Type, "complexType") in x.DefinedIn or (p.Type, "group") in x.DefinedIn:
                        element = x
                        break                     
    
    return element


def getComplexTypes(tree, NSMAP):
    """ Returns a list of the complexType components in the specified tree.
    """   

    # 
    # Build list of named complexTypes 

    namedComplexTypes=[]    

    types = tree.xpath("//xs:complexType", namespaces=NSMAP)

    for type in filter(lambda x: x.attrib.get('name','') != '', types):
    
        t = ComplexType()
        t.Name = type.attrib.get('name','')    

        # Get type documentation    
        doc = type.xpath("xs:annotation/xs:documentation", namespaces=NSMAP)
        if len(doc):
            t.Documentation = doc[0].text

        # Global element or local?
        parent = type.getparent()

        if parent.tag == '{https://www.w3.org/2001/XMLSchema}schema':
            t.IsGlobal = True

        # Get type XML source
        t.XmlSource = etree.tostring(type, encoding='unicode',pretty_print=True)

        # Get tag attributes
        t.TagAttributes = dict(type.attrib)

        # get complexType attributes
        typeAttrs = type.xpath("xs:attribute", namespaces=NSMAP)
        for attr in typeAttrs:
            a = Attribute()
            a.Name = attr.attrib.get('name')
            a.Attributes = dict(attr.attrib)
            a.XmlSource = etree.tostring(attr, encoding='unicode',pretty_print=True)
        
            attrdoc = attr.xpath("xs:annotation/xs:documentation", namespaces=NSMAP)
            if len(attrdoc):
                a.Documentation = attrdoc[0].text
            t.Attributes.append(a)
        
        # Get content elements
        contentElements = type.xpath('xs:sequence/xs:element', namespaces=NSMAP)
        if len(contentElements) == 0:            
            contentElements = type.xpath('xs:all/xs:element', namespaces=NSMAP)
            if len(contentElements) == 0:
                contentElements = type.xpath('xs:choice/xs:element', namespaces=NSMAP)
                if len(contentElements) == 0:
                    contentElements = type.xpath('xs:sequence/xs:choice/xs:element', namespaces=NSMAP)

        # Process the content elements
        for contentEl in contentElements:
            c = Element()
            c.Name = contentEl.attrib.get('name')       
    
            # Get element documentation
        
            doc = contentEl.xpath("xs:annotation/xs:documentation", namespaces=NSMAP)
            if len(doc):
                c.Documentation = doc[0].text

            # Get element XML source
            c.XmlSource = etree.tostring(contentEl, encoding='unicode',pretty_print=True)

            # Get element attributes
            c.TagAttributes = dict(contentEl.attrib)
            
            # Add to list of content elements
            t.ContentElements.append(c)

        # Add to list
        namedComplexTypes.append(t)

    return namedComplexTypes

def getElements(tree, NSMAP, complexTypes=None):
    """ Gets a list of the element components in the specified tree.
    """

    if complexTypes==None:
        complexTypes = getComplexTypes(tree, NSMAP)

    namedElements = []

    #
    # Build list of named Elements
    elements = tree.xpath("//xs:element", namespaces=NSMAP)
    for elem in filter(lambda x: x.attrib.get('name','') != '', elements):              
        
        name = elem.attrib.get('name','')

        # What type is it?
        type = elem.attrib.get("type", "anonymous complexType")

        # Global element or local?
        parent = elem.getparent()        
        
        if parent.tag == '{https://www.w3.org/2001/XMLSchema}schema':
            isGlobal = True
            defin = None
        else:
            isGlobal = False
            # Find where the element is defined
            while(parent.attrib.get('name','') == ''):
                parent = parent.getparent()
            defin=((parent.attrib.get('name'), parent.tag[parent.tag.find('}')+1:] ))
        
        # Get element documentation    
        docEl = elem.xpath("xs:annotation/xs:documentation", namespaces=NSMAP)
        
        doc=""
        if(docEl):
            doc= docEl[0].text
        else:
            # If element doesn't have documentation, try to grab docs from the complexType
            if (type != "anonymous complexType"):
                complexType = next(( x for x in complexTypes if (x.Name == type)), None)
                if (complexType):
                    doc = complexType.Documentation
        
        # This element (of a type) already in the list?
        el2 =next((x for x in namedElements if (x.Type != "anonymous complexType" and x.Name == name and x.Type == type)), None)
        if el2 != None:
            el2.DefinedIn.append(defin)
            if(el2.Documentation == ""):
                el2.Documentation =doc
        else:

            el = Element()

            el.Name = name
            el.Type = type
            el.IsGlobal = isGlobal
            if defin != None:
                el.DefinedIn.append( defin )

            if len(doc):
                # This is a list because element instances of same complexType can have multiple doc annotations throughout XSD.
                el.Documentation= doc

            # Get element XML source
            el.XmlSource = etree.tostring(elem, encoding='unicode',pretty_print=True)

            # Get element attributes
            el.TagAttributes = dict(elem.attrib)

            # Is it a complexType?  To do:  checking here, but already assuming it's anonymous complexType
            type = elem.xpath("xs:complexType", namespaces=NSMAP)
            if len(type):
   
                # get complexType attributes
                typeAttrs = type[0].xpath("xs:attribute", namespaces=NSMAP)
                for attr in typeAttrs:
                    a = Attribute()
                    a.Name = attr.attrib.get('name')
                    a.Attributes = dict(attr.attrib)
                    a.XmlSource = etree.tostring(attr, encoding='unicode',pretty_print=True)
            
                    attrdoc = attr.xpath("xs:annotation/xs:documentation", namespaces=NSMAP)
                    if len(attrdoc):
                        a.Documentation = attrdoc[0].text
                    el.Attributes.append(a)
        
                # Get content elements
                contentElements = type[0].xpath('xs:sequence/xs:element', namespaces=NSMAP)
                if len(contentElements) == 0:            
                    contentElements = type[0].xpath('xs:all/xs:element', namespaces=NSMAP)
                    if len(contentElements) == 0:
                        contentElements = type[0].xpath('xs:choice/xs:element', namespaces=NSMAP)
                        if len(contentElements) == 0:
                            contentElements = type[0].xpath('xs:sequence/xs:choice/xs:element', namespaces=NSMAP)

                # Process the content elements
                for contentEl in contentElements:
                    c = Element()
                    c.Name = contentEl.attrib.get('name')       
    
                    # Get element documentation
            
                    doc = contentEl.xpath("xs:annotation/xs:documentation", namespaces=NSMAP)
                    if len(doc):
                        c.Documentation = doc[0].text

                    # Get element XML source
                    c.XmlSource = etree.tostring(contentEl, encoding='unicode',pretty_print=True)

                    # Get element attributes
                    c.TagAttributes = dict(contentEl.attrib)
            
                    # Add to list of content elements
                    el.ContentElements.append(c)

                ## to do- complexContent
                ## to do- simpleContent

            # Add to list
            namedElements.append(el)
    
    # Set the ID fields. Do this last, need to know all places the element is defined.
    for e in namedElements:
        id = e.Name+"Element"+e.Type+"ComplexType"
        
        for defin in e.DefinedIn:
            #print("%s: %s" %(id, defin))
            id+="DefinedIn%s%s"%(defin[0], defin[1])
        
        e.Id =id.replace(" ", "")
        #print("ID %s" % id)
    
    return namedElements

def getSimpleTypes(tree, NSMAP):
    """ Returns a list of simpleType components in the specified tree.
    """

    namedSimpleTypes=[]

    #
    # Build list of named simple types
    simpleTypes = tree.xpath("//xs:simpleType", namespaces=NSMAP)

    for simpleType in filter(lambda x: x.attrib.get('name','') != '', simpleTypes):
        st = SimpleType()
        st.Name = simpleType.attrib.get('name','')

        # Get simple type documentation
    
        doc = simpleType.xpath("xs:annotation/xs:documentation", namespaces=NSMAP)
        if len(doc):
            st.Documentation = doc[0].text

        # Get element XML source
        st.XmlSource = etree.tostring(simpleType, encoding='unicode')

        namedSimpleTypes.append(st)

    return namedSimpleTypes

def getElementGroups(tree, NSMAP):
    """ Returns a list of the elementGroup components in the specified tree.
    """

    namedElementGroups = []

    #
    # Build list of named element groups
    elemGroups = tree.xpath("//xs:group", namespaces=NSMAP)

    for elemGroup in filter(lambda x: x.attrib.get('name','') != '', elemGroups): 
        eg = ElementsGroup()
        eg.Name = elemGroup.attrib.get('name','')    

        # Get element documentation    
        doc = elemGroup.xpath("xs:annotation/xs:documentation", namespaces=NSMAP)
        if len(doc):
            eg.Documentation = doc[0].text

        # Get content elements
        contentElements = elemGroup.xpath('xs:sequence/xs:element', namespaces=NSMAP)
        if len(contentElements) == 0:            
            contentElements = elemGroup.xpath('xs:all/xs:element', namespaces=NSMAP)
            if len(contentElements) == 0:
                contentElements = elemGroup.xpath('xs:choice/xs:element', namespaces=NSMAP)
                if len(contentElements) == 0:
                    contentElements = elemGroup.xpath('xs:sequence/xs:choice/xs:element', namespaces=NSMAP)

        # Process the content elements
        for contentEl in contentElements:
            c = Element()
            c.Name = contentEl.attrib.get('name')       
    
            # Get element documentation            
            doc = contentEl.xpath("xs:annotation/xs:documentation", namespaces=NSMAP)
            if len(doc):
                c.Documentation = doc[0].text

            # Get element XML source
            c.XmlSource = etree.tostring(contentEl, encoding='unicode',pretty_print=True)

            # Get element attributes
            c.TagAttributes = dict(contentEl.attrib)
            
            # Add to list of content elements
            eg.ContentElements.append(c)

        ## to do- complexContent
        ## to do- simpleContent

        # Get element XML source
        eg.XmlSource = etree.tostring(elemGroup, encoding='unicode')

        namedElementGroups.append(eg)

    return namedElementGroups

def getAttributeGroups(tree, NSMAP):
    """ Returns a list of the attributeGroup components in the specified tree.
    """

    namedAttributeGroups=[]
    # 
    # Build list of named attributeGroups

    attrGroups = tree.xpath("//xs:attributeGroup", namespaces=NSMAP)

    for attrGroup in filter(lambda x: x.attrib.get('name','') != '', attrGroups):
    
        ag = AttributeGroup()
        ag.Name = attrGroup.attrib.get('name','')    

        # Get element documentation
    
        doc = attrGroup.xpath("xs:annotation/xs:documentation", namespaces=NSMAP)
        if len(doc):
            ag.Documentation = doc[0].text

        # Get element XML source
        ag.XmlSource = etree.tostring(attrGroup, encoding='unicode')

        # Get element attributes
        ag.TagAttributes = dict(attrGroup.attrib)

        # get group attributes
        attrs = attrGroup.xpath("xs:attribute", namespaces=NSMAP)
        for attr in attrs:
            a = Attribute()
            a.Name = attr.attrib.get('name')
            a.Attributes = dict(attr.attrib)
            a.XmlSource = etree.tostring(attr, encoding='unicode')
        
            attrdoc = attr.xpath("xs:annotation/xs:documentation", namespaces=NSMAP)
            if len(attrdoc):
                a.Documentation = attrdoc[0].text
            ag.GroupAttributes.append(a)

        namedAttributeGroups.append(ag)

    return namedAttributeGroups



-->