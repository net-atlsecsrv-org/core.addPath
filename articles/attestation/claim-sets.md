---
title: Azure Attestation Claim sets
description: The claim sets of Azure Attestation.
services: attestation
author: msmbaldwin
ms.service: attestation
ms.topic: overview
ms.date: 08/31/2020
ms.author: mbaldwin


---
# Claim sets

Claims generated in the process of attesting enclaves using Microsoft Azure Attestation can be divided into the below categories:

- **Incoming claims**: The claims generated by Microsoft Azure Attestation after parsing the attestation evidence and can be used by policy authors to define authorization rules in a custom policy

- **Outgoing claims**: The claims generated by Azure Attestation and contains all claims that end up in the attestation token

- **Property claims**: The claims created as an output by Azure Attestation. It contains all the claims that represent properties of the attestation token, such as encoding of the report, validity duration of the report, and so on.

### Common incoming claims across all attestation types

Below claims are generated by Azure Attestation and can be used by policy authors to define authorization rules in a custom policy for all attestation types.

- **x-ms-ver**: JWT schema version (expected to be "1.0")
- **x-ms-attestation-type**: String value representing attestation type 
- **x-ms-policy-hash**: Hash of Azure Attestation evaluation policy computed as BASE64URL(SHA256(UTF8(BASE64URL(UTF8(policy text)))))
- **x-ms-policy-signer**: JSON object with a "jwk” member representing the key a customer used to sign their policy, when customer uploads a signed policy

Below claims are considered deprecated but are fully supported. It is recommended to use the non-deprecated claim names.

Deprecated claim | Recommended claim 
--- | --- 
ver | x-ms-ver
tee | x-ms-attestation-type
maa-policyHash | x-ms-policy-hash
policy_hash | x-ms-policy-hash
policy_signer | x-ms-policy-signer

### Common outgoing claims across all attestation types

Below claims are included in the attestation token for all attestation types by the service.

Source: As defined by [IETF JWT](https://tools.ietf.org/html/rfc7519)

- **"jti" (JWT ID) Claim**
- **"iss" (Issuer) Claim**
- **"iat" (Issued At) Claim**
- **"exp" (Expiration Time) Claim**
- **"nbf" (Not Before) Claim**

Source: As defined by [IETF EAT](https://tools.ietf.org/html/draft-ietf-rats-eat-03#page-9)

- **"Nonce claim" (nonce)**

Below claims are included in the attestation token by default based on the incoming claims:

- **x-ms-ver**: JWT schema version (expected to be "1.0")
- **x-ms-attestation-type**: String value representing attestation type 
- **x-ms-policy-hash**: String value containing SHA256 hash of the policy text computed by BASE64URL(SHA256(UTF8(BASE64URL(UTF8(policy text)))))
- **x-ms-policy-signer**: Contains a JWK with the public key or the certificate chain present in the signed policy header. x-ms-policy-signer is only added if the policy is signed

## Claims specific to SGX enclaves

### Incoming claims specific to SGX attestation

Below claims are generated by Azure Attestation and can be used by policy authors to define authorization rules in a custom policy for SGX attestation.

- **x-ms-sgx-is-debuggable**: A Boolean, which indicates whether or not the enclave has debugging enabled or not
- **x-ms-sgx-product-id**
- **x-ms-sgx-mrsigner**: hex encoded value of the “mrsigner” field of the quote
- **x-ms-sgx-mrenclave**: hex encoded value of the “mrenclave” field of the quote
- **x-ms-sgx-svn**: security version number encoded in the quote 

### Outgoing claims specific to SGX attestation

Below claims are generated and included in the attestation token by the service for SGX attestation.

- **x-ms-sgx-is-debuggable**: A Boolean, which indicates whether or not the enclave has debugging enabled or not
- **x-ms-sgx-product-id**
- **x-ms-sgx-mrsigner**: hex encoded value of the “mrsigner” field of the quote
- **x-ms-sgx-mrenclave**: hex encoded value of the “mrenclave” field of the quote
- **x-ms-sgx-svn**: security version number encoded in the quote 
- **x-ms-sgx-ehd**: enclave held data formatted as BASE64URL(enclave held data)
- **x-ms-sgx-collateral**: JSON object describing the collateral used to perform attestation. The value for the x-ms-sgx-collateral claim is a nested JSON object with the following key/value pairs:
    - **qeidcertshash**: SHA256 value of QE Identity issuing certs
    - **qeidcrlhash**: SHA256 value of QE Identity issuing certs CRL list
    - **qeidhash**: SHA256 value of the QE Identity collateral
    - **quotehash**: SHA256 value of the evaluated quote
    - **tcbinfocertshash**: SHA256 value of the TCB Info issuing certs
    - **tcbinfocrlhash**: SHA256 value of the TCB Info issuing certs CRL list
    - **tcbinfohash**: JSON object describing the collateral used to perform attestation

Below claims are considered deprecated but are fully supported and will continue to be included in the future. It is recommended to use the non-deprecated claim names.

Deprecated claim | Recommended claim
--- | --- 
$is-debuggable | x-ms-sgx-is-debuggable
$sgx-mrsigner | x-ms-sgx-mrsigner
$sgx-mrenclave | x-ms-sgx-mrenclave
$product-id | x-ms-sgx-product-id
$svn | x-ms-sgx-svn
$tee | x-ms-attestation-type
maa-ehd | x-ms-sgx-ehd
aas-ehd | x-ms-sgx-ehd
maa-attestationcollateral | x-ms-sgx-collateral

## Claims specific to Trusted Platform Module (TPM)/ VBS attestation

### Incoming claims for TPM attestation

Claims issued by Azure Attestation for TPM attestation. The availability of the claims is dependent on the evidence provided for attestation.

- **aikValidated**: Boolean value containing information if the Attestation Identity Key (AIK) cert has been validated or not
- **aikPubHash**:  String containing the base64(SHA256(AIK public key in DER format))
- **tpmVersion**:   Integer value containing the Trusted Platform Module (TPM) major version
- **secureBootEnabled**: Boolean value to indicate if secure boot is enabled
- **iommuEnabled**:  Boolean value to indicate if Input-output memory management unit (Iommu) is enabled
- **bootDebuggingDisabled**: Boolean value to indicate if boot debugging is disabled
- **notSafeMode**:  Boolean value to indicate if the Windows is not running on safe mode
- **notWinPE**:  Boolean value indicating if Windows is not running in WinPE mode
- **vbsEnabled**:  Boolean value indicating if VBS is enabled
- **vbsReportPresent**:  Boolean value indicating if VBS enclave report is available

### Incoming claims for VBS attestation

Claims issued by Azure Attestation for VBS attestation is in addition to the claims made available for TPM attestation. The availability of the claims is dependent on the evidence provided for attestation.

- **enclaveAuthorId**:  String value containing the Base64Url encoded value of the enclave author id-The author identifier of the primary module for the enclave
- **enclaveImageId**:  String value containing the Base64Url encoded value of the enclave Image id-The image identifier of the primary module for the enclave
- **enclaveOwnerId**:  String value containing the Base64Url encoded value of the enclave Owner id-The identifier of the owner for the enclave
- **enclaveFamilyId**:  String value containing the Base64Url encoded value of the enclave Family ID. The family identifier of the primary module for the enclave
- **enclaveSvn**:  Integer value containing the security version number of the primary module for the enclave
- **enclavePlatformSvn**:  Integer value containing the security version number of the platform that hosts the enclave
- **enclaveFlags**:  The enclaveFlags claim is an Integer value containing Flags that describe the runtime policy for the enclave

### Outgoing claims specific to TPM and VBS attestation

- **cnf (Confirmation)**: The "cnf" claim is used to identify the proof-of-possession key. Confirmation claim as defined in RFC 7800, contains the public part of the attested enclave key represented as a JSON Web Key (JWK) object (RFC 7517)
- **rp_data (relying party data)**: Relying party data, if any, specified in the request, used by the relying party as a nonce to guarantee freshness of the report. rp_data is only added if there is rp_data

### Property claims

- **report_validity_in_minutes**: An integer claim signifying for how long the token is valid.
  - **Default value(time)**: One day in minutes.
  - **Maximum value(time)**: One year in minutes.
- **omit_x5c**: A Boolean claim indicating if Azure Attestation should omit the cert used to provide proof of service authenticity. If true, x5t will be added to the attestation token. If false(default), x5c will be added to the attestation token.

## Next steps
- [How to author and sign an attestation policy](author-sign-policy.md)
- [Set up Azure Attestation using PowerShell](quickstart-powershell.md)
