---
# Mandatory fields.
title: Manage endpoints and routes (portal)
titleSuffix: Azure Digital Twins
description: See how to set up and manage endpoints and event routes for Azure Digital Twins data using the Azure portal.
author: baanders
ms.author: baanders # Microsoft employees only
ms.date: 7/22/2020
ms.topic: how-to
ms.service: digital-twins

# Optional fields. Don't forget to remove # if you need a field.
# ms.custom: can-be-multiple-comma-separated
# ms.reviewer: MSFT-alias-of-reviewer
# manager: MSFT-alias-of-manager-or-PM-counterpart
---

# Manage endpoints and routes in Azure Digital Twins (portal)

[!INCLUDE [digital-twins-route-selector.md](../../includes/digital-twins-route-selector.md)]

In Azure Digital Twins, you can route [event notifications](how-to-interpret-event-data.md) to downstream services or connected compute resources. This is done by first setting up **endpoints** that can receive the events. You can then create [**event routes**](concepts-route-events.md) that specify which events generated by Azure Digital Twins are delivered to which endpoints.

This article walks you through the process of creating endpoints and routes using the [Azure portal](https://portal.azure.com).

You can also manage endpoints and routes with the [EventRoutes APIs](how-to-use-apis-sdks.md), the [.NET (C#) SDK](https://github.com/Azure/azure-sdk-for-net/tree/master/sdk/digitaltwins/Azure.DigitalTwins.Core), or the [Azure Digital Twins CLI](how-to-use-cli.md). For a version of this article that uses these mechanisms instead of the portal, see [*How-to: Manage endpoints and routes (APIs and CLI)*](how-to-manage-routes-apis-cli.md).

## Prerequisites

* You'll need an **Azure account** (you can set one up for free [here](https://azure.microsoft.com/free/?WT.mc_id=A261C142F))
* You'll need an **Azure Digital Twins instance** in your Azure subscription. If you don't have an instance already, you can create one using the steps in [*How-to: Set up an instance and authentication*](how-to-set-up-instance-scripted.md). Have the following values from setup handy to use later in this article:
    - Instance name
    - Resource group

You can find these details in the [Azure portal](https://portal.azure.com) after setting up your instance. Log into the portal and search for the name of your instance in the portal search bar.
 
:::image type="content" source="media/how-to-manage-routes-portal/search-field-portal.png" alt-text="Screenshot of Azure portal search bar.":::

Select your instance from the results to see the details page for your instance:

:::image type="content" source="media/how-to-manage-routes-portal/instance-details.png" alt-text="Screenshot of ADT instance details." border="false":::

## Create an endpoint for Azure Digital Twins

These are the supported types of endpoints that you can create for your instance:
* [Event Grid](../event-grid/overview.md) 
* [Event Hubs](../event-hubs/event-hubs-about.md)
* [Service Bus](../service-bus-messaging/service-bus-messaging-overview.md)

For more information on the different endpoint types, see [*Choose between Azure messaging services*](../event-grid/compare-messaging-services.md).

To link an endpoint to Azure Digital Twins, the event grid topic, event hub, or Service Bus that you're using for the endpoint needs to exist already. 

### Create an Event Grid endpoint

**Prerequisite**: Create an event grid topic by following the steps in [the *Create a custom topic* section](../event-grid/custom-event-quickstart-portal.md#create-a-custom-topic) of the Event Grid *Custom events* quickstart.

Once you have created the topic, you can link it to Azure Digital Twins from your Azure Digital Twins instance's page in the [Azure portal](https://portal.azure.com) (you can find the instance by entering its name into the portal search bar).

From the instance menu, select _Endpoints_. Then from the *Endpoints* page that follows, select *+ Create an endpoint*. 

On the *Create an Endpoint* page that opens up, you can create an endpoint of type _Event Grid_ by selecting the corresponding radio button. Complete the other details: enter a name for your endpoint in the _Name_ field, choose your _Subscription_ from the dropdown, and choose your pre-created  _Event Grid Topic_ from the third dropdown.

Then, create your endpoint by hitting _Save_.

:::image type="content" source="media/how-to-manage-routes-portal/create-endpoint-event-grid.png" alt-text="Screenshot of creating an endpoint of type Event Grid.":::

You can verify that the endpoint is successfully created by checking the notification icon in the top Azure portal bar: 

:::image type="content" source="media/how-to-manage-routes-portal/create-endpoint-notifications.png" alt-text="Screenshot of notification to verify the creation of endpoint." border="false":::

You can also view the endpoint that was created back on the *Endpoints* page for your Azure Digital Twins instance.

If the endpoint creation fails, observe the error message and retry after a few minutes.

Now, the event grid topic is available as an endpoint inside of Azure Digital Twins, under the name specified in the _Name_ field. You will typically use that name as the target of an **event route**, which you'll create [later in this article](#event-routes).

### Create an Event Hubs endpoint

**Prerequisites**: 
* You'll need an _Event Hubs namespace_ and an _event hub_. Create both of these by following the steps in the Event Hubs [*Create an event hub*](../event-hubs/event-hubs-create.md) quickstart.
* You'll need an _authorization rule_. To create this, refer to the Event Hubs [*Authorizing access to Event Hubs resources using Shared Access Signatures*](../event-hubs/authorize-access-shared-access-signature.md) article.

Go to the details page for your Azure Digital Twins instance in the [Azure portal](https://portal.azure.com) (you can find it by entering its name into the portal search bar).

From the instance menu, select _Endpoints_. Then from the *Endpoints* page that follows, select *+ Create an endpoint*. 

On the *Create an Endpoint* page that opens up, you can create an endpoint of type _Event Hub_ by selecting the corresponding radio button. Enter a name for your endpoint in the _Name_ field. Then select your _Subscription_, and your pre-created _Event hub namespace_, _Event Hub_, and _Authorization rule_ from the respective dropdowns.

Then, create your endpoint by hitting _Save_.

:::image type="content" source="media/how-to-manage-routes-portal/create-endpoint-event-hub.png" alt-text="Screenshot of creating an endpoint of type Event Hubs.":::

You can verify that the endpoint is successfully created by checking the notification icon in the top Azure portal bar. 

If the endpoint creation fails, observe the error message and retry after a few minutes.

Now, the Event hub is available as an endpoint inside of Azure Digital Twins, under the name specified in the _Name_ field. You will typically use that name as the target of an **event route**, which you'll create [later in this article](#event-routes).

### Create a Service Bus endpoint

**Prerequisites**: 
* You'll need a _Service Bus namespace_ and a _Service Bus topic_. Create both of these by following the steps in the Service Bus [*Create topics and subscriptions*](../service-bus-messaging/service-bus-quickstart-topics-subscriptions-portal.md) quickstart. You do not need to complete the [*Create subscriptions to the topic*](../service-bus-messaging/service-bus-quickstart-topics-subscriptions-portal.md#create-subscriptions-to-the-topic) section.
* You'll need an _Authorization rule_. To create this, refer to the Service Bus [*Authentication and authorization*](../service-bus-messaging/service-bus-authentication-and-authorization.md#shared-access-signature) article.

Go to the details page for your Azure Digital Twins instance in the [Azure portal](https://portal.azure.com) (you can find it by entering its name into the portal search bar).

From the instance menu, select _Endpoints_. Then from the *Endpoints* page that follows, select *+ Create an endpoint*. 

On the *Create an Endpoint* page that opens up, you can create an endpoint of type _Service Bus_ by selecting the corresponding radio button. Enter a name for your endpoint in the _Name_ field. Then select your _Subscription_, and your pre-created _Service Bus namespace_, _Service Bus topic_, and _Authorization rule_ from the respective dropdowns.

Then, create your endpoint by hitting _Save_.

:::image type="content" source="media/how-to-manage-routes-portal/create-endpoint-service-bus.png" alt-text="Screenshot of creating an endpoint of type Service Bus.":::

You can verify that the endpoint is successfully created by checking the notification icon in the top Azure portal bar. 

If the endpoint creation fails, observe the error message and retry after a few minutes.

Now, the Service Bus topic is available as an endpoint inside of Azure Digital Twins, under the name specified in the _Name_ field. You will typically use that name as the target of an **event route**, which you'll create [later in this article](#event-routes).

## Event routes

To actually send data from Azure Digital Twins to an endpoint, you'll need to define an **event route**. These routes let developers wire up event flow, throughout the system and to downstream services. Read more about event routes in [*Concepts: Routing Azure Digital Twins events*](concepts-route-events.md).

**Prerequisite**: You need to create endpoints as described earlier in this article before you can move on to creating a route. You can proceed to creating an event route once your endpoints are finished setting up.

>[!NOTE]
>If you have recently deployed your endpoints, validate that they're finished deploying **before** attempting to use them for a new event route. If you're unable to set up the route because the endpoints aren't ready, wait a few minutes and try again.

### Create an event route 

An event route definition contains these elements:
* The route name you want to use
* The name of the endpoint you want to use
* A filter that defines which events are sent to the endpoint
    - To disable the route so that no events are sent, use a filter value of `false`
    - To enable a route that has no specific filtering, use a filter value of `true`
    - For details on any other type of filter, see the [*Filter events*](#filter-events) section below.

A single route can allow multiple notifications and event types to be selected.

To create an event route, go to the details page for your Azure Digital Twins instance in the [Azure portal](https://portal.azure.com) (you can find the instance by entering its name into the portal search bar).

From the instance menu, select _Event routes_. Then from the *Event routes* page that follows, select *+ Create an event route*. 

On the *Create an event route* page that opens up, choose at minimum:
* A name for your route in the _Name_ field
* The _Endpoint_ you would like to use to create the route 

For the route to be enabled, you must also **Add an event route filter** of at least `true`. (Leaving the default value of `false` will create the route, but no events will be sent to it.) To do this, toggle the switch for the _Advanced editor_ to enable it, and write `true` in the *Filter* box.

:::image type="content" source="media/how-to-manage-routes-portal/create-event-route-no-filter.png" alt-text="Screenshot of creating event route for your instance." lightbox="media/how-to-manage-routes-portal/create-event-route-no-filter.png":::

When finished, hit the _Save_ button to create your event route.

### Filter events

As described above, routes have a **filter** field. If the filter value on your route is `false`, no events will be sent to your endpoint. 

After enabling the minimal filter of `true`, endpoints will receive a variety of events from Azure Digital Twins:
* Telemetry fired by [digital twins](concepts-twins-graph.md) using the Azure Digital Twins service API
* Twin property change notifications, fired on property changes for any twin in the Azure Digital Twins instance
* Life-cycle events, fired when twins or relationships are created or deleted
* Model change events, fired when [models](concepts-models.md) configured in an Azure Digital Twins instance are added or deleted

You can restrict the types of events being sent by defining a more-specific filter.

To add an event filter while you are creating an event route, use the _Add an event route filter_ section of the *Create an event route* page. 

You can either select from some basic common filter options, or use the advanced filter options to write your own custom filters.

#### Use the basic filters

To use the basic filters, expand the _Event types_ option and select the checkboxes corresponding to the events you'd like to send to your endpoint. 

:::row:::
    :::column:::
        :::image type="content" source="media/how-to-manage-routes-portal/create-event-route-filter-basic-1.png" alt-text="Screenshot of creating an event route with a basic filter. Selecting the checkboxes of the events.":::
    :::column-end:::
    :::column:::
    :::column-end:::
:::row-end:::

This will auto-populate the filter text box with the text of the filter you've selected:

:::row:::
    :::column:::
        :::image type="content" source="media/how-to-manage-routes-portal/create-event-route-filter-basic-2.png" alt-text="Screenshot of creating an event route with a basic filter. Showing the auto-populated filter text after selecting the events.":::
    :::column-end:::
    :::column:::
    :::column-end:::
:::row-end:::

#### Use the advanced filters

Alternatively, you can use the advanced filter option to write your own custom filters.

To create an event route with advanced filter options, toggle the switch for the _Advanced editor_ to enable it. You can then write your own event filters in the *Filter* box:

:::row:::
    :::column:::
        :::image type="content" source="media/how-to-manage-routes-portal/create-event-route-filter-advanced.png" alt-text="Screenshot of creating an event route with an advanced filter.":::
    :::column-end:::
    :::column:::
    :::column-end:::
:::row-end:::

Here are the supported route filters. The detail in the *Filter text schema* column is the text that can be entered into the filter box.

[!INCLUDE [digital-twins-route-filters](../../includes/digital-twins-route-filters.md)]

[!INCLUDE [digital-twins-route-metrics](../../includes/digital-twins-route-metrics.md)]

## Next steps

Read about the different types of event messages you can receive:
* [*How-to: Interpret event data*](how-to-interpret-event-data.md)
