---
# Mandatory fields.
title: Create custom-language SDKs with AutoRest
titleSuffix: Azure Digital Twins
description: Learn how to use AutoRest to generate custom-language SDKs, for writing Azure Digital Twins code in other languages that don't have published SDKs.
author: baanders
ms.author: baanders # Microsoft employees only
ms.date: 3/9/2021
ms.topic: how-to
ms.service: digital-twins
ms.custom: [devx-track-js, contperf-fy21q3]

# Optional fields. Don't forget to remove # if you need a field.
# ms.custom: can-be-multiple-comma-separated
# ms.reviewer: MSFT-alias-of-reviewer
# manager: MSFT-alias-of-manager-or-PM-counterpart
---

# Create custom-language SDKs for Azure Digital Twins using AutoRest

If you need to work with Azure Digital Twins using a language that does not have a [published Azure Digital Twins SDK](how-to-use-apis-sdks.md), this article will show you how to use AutoRest to generate your own SDK in the language of your choice. 

The examples in this article show the creation of a [data plane SDK](how-to-use-apis-sdks.md#overview-data-plane-apis), but this process will work for generating a  [control plane SDK](how-to-use-apis-sdks.md#overview-control-plane-apis) as well.

## Prerequisites

To generate an SDK, you'll first need to complete the following setup on your local machine:
* Install [**AutoRest**](https://github.com/Azure/autorest), version 2.0.4413 (version 3 isn't currently supported)
* Install [**Node.js**](https://nodejs.org), which is a pre-requisite for using AutoRest
* Install [**Visual Studio**](https://visualstudio.microsoft.com/downloads/)
* Download the latest Azure Digital Twins **data plane Swagger** (OpenAPI) file from the [data plane Swagger folder](https://github.com/Azure/azure-rest-api-specs/tree/master/specification/digitaltwins/data-plane/Microsoft.DigitalTwins), along with its accompanying folder of examples. The Swagger file is the one called *digitaltwins.json*.

>[!TIP]
> To create a **control plane SDK** instead, complete the steps in this article using the latest **control plane Swagger** (OpenAPI) file from the [control plane Swagger folder](https://github.com/Azure/azure-rest-api-specs/tree/master/specification/digitaltwins/resource-manager/Microsoft.DigitalTwins/) instead of the data plane one.

Once your machine is equipped with everything from the list above, you're ready to use AutoRest to create an SDK.

## Create the SDK using AutoRest 

Once you have Node.js installed, you can run this command to make sure you have the required version of AutoRest installed:
```cmd/sh
npm install -g autorest@2.0.4413
```

To run AutoRest against the Azure Digital Twins Swagger file, follow these steps:
1. Copy the Azure Digital Twins Swagger file and its accompanying folder of examples into a working directory.
2. Use a command prompt window to switch to that working directory.
3. Run AutoRest with the following command. Replace the `<language>` placeholder with your language of choice: `python`, `java`, `go`, and so on. (You can find the full list of options in the [AutoRest README](https://github.com/Azure/autorest).)

```cmd/sh
autorest --input-file=digitaltwins.json --<language> --output-folder=DigitalTwinsApi --add-credentials --azure-arm --namespace=DigitalTwinsApi
```

As a result, you'll see a new folder named *DigitalTwinsApi* in your working directory. The generated SDK files will have the namespace *DigitalTwinsApi*. You'll continue to use that namespace through the rest of the usage examples in this article.

AutoRest supports a wide range of language code generators.

## Make the SDK into a class library

You can include the files generated by AutoRest directly into a .NET solution. However, it's likely that you'll want to include the Azure Digital Twins SDK in several separate projects (your client apps, Azure Functions apps, and more). For this reason, it can be useful to build a separate project (a .NET class library) from the generated files. Then, you can include this class library project into several solutions as a project reference.

This section gives instructions on how to build the SDK as a class library, which is its own project and can be included into other projects. These steps rely on **Visual Studio**.

Here are the steps:

1. Create a new Visual Studio solution for a class library
2. Use *DigitalTwinsApi* as the project name
3. In Solutions Explorer, right-select the *DigitalTwinsApi* project of the generated solution and choose *Add > Existing Item...*
4. Find the folder where you generated the SDK, and select the files at the root level
5. Press "Ok"
6. Add a folder to the project (right-select the project in Solution Explorer, and choose *Add > New Folder*)
7. Name the folder *Models*
8. Right-select the *Models* folder in Solutions Explorer and select *Add > Existing Item...*
9. Select the files in the *Models* folder of the generated SDK and press "Ok"

To build the SDK successfully, your project will need these references:
* `Microsoft.Rest.ClientRuntime`
* `Microsoft.Rest.ClientRuntime.Azure`

To add these, open *Tools > NuGet Package Manager > Manage NuGet Packages for Solution...*.

1. In the panel, make sure the *Browse* tab is selected
2. Search for *Microsoft.Rest*
3. Select the `ClientRuntime` and `ClientRuntime.Azure` packages, and add them to your solution

You can now build the project, and include it as a project reference in any Azure Digital Twins application you write.

## Tips for using the SDK

This section contains general information and guidelines for using the generated SDK.

### Synchronous and asynchronous calls

All SDK functions come in synchronous and asynchronous versions.

### Typed and untyped data

REST API calls generally return strongly typed objects. However, because Azure Digital Twins lets users define their own custom types for twins, there is no way to pre-define static return data for many Azure Digital Twins calls. 
Instead, the APIs return strongly typed wrapper types where applicable, and the custom-typed twin data is in Json.NET objects (used wherever the data type "object" appears in the API signatures). You can cast these objects appropriately in your code.

### Error handling

Whenever an error occurs in the SDK (including HTTP errors such as 404), the SDK will throw an exception. For this reason, it's important to encapsulate all API calls within try/catch blocks.

Here is a code snippet that tries to add a twin and catches any errors in this process:

:::code language="csharp" source="~/digital-twins-docs-samples/sdks/csharp/twin_operations_other.cs" id="CreateTwin_errorHandling":::

### Paging

AutoRest generates two types of paging patterns for the SDK:
* One for all APIs except the Query API
* One for the Query API

In the non-query paging pattern, here is a sample method showing how to retrieve a paged list of outgoing relationships from Azure Digital Twins:

:::code language="csharp" source="~/digital-twins-docs-samples/sdks/csharp/graph_operations_sample.cs" id="FindOutgoingRelationshipsMethod":::

The second pattern is only generated for the Query API. It uses a `continuationToken` explicitly.

>[!TIP]
> A main reason for getting pages is to calculate the [Query Unit charges](concepts-query-units.md) for a Query API call.

Here is an example with this pattern:

:::code language="csharp" source="~/digital-twins-docs-samples/sdks/csharp/queries.cs" id="PagedQuery":::

## Next steps

Walk through the steps to create a client app where you can use your SDK:
* [*Tutorial: Code a client app*](tutorial-code.md)
